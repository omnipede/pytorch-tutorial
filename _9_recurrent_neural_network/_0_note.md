# 순환 신경망

## 순환 신경망 (RNN)

합성 곱 신경망과 같이 은닉층의 결과 값이 출력층 방향으로만 향하는 신경망을 피드 포워드 신경망이라고 한다. 반면 은닉층의 결과 값을 출력층과 은닉층의 입력으로 보내는 신경망을
순환 신경망 (RNN) 이라고 한다.

<img width="735" alt="스크린샷 2022-02-24 오후 3 26 02" src="https://user-images.githubusercontent.com/41066039/155469965-0accda53-983c-4c99-a2b4-c8d97c31fbca.png">

RNN 의 은닉층은 셀 (cell) 로 이루어져 있는데 셀은 이전 상태 (state) 를 기억하는 성질이 있다. 즉 이전 시점 (time step) 의 결과 값을 자신의 입력으로 사용하는 것이다.
메모리 셀이 출력층 방향으로 또는 다음 시점 자신에게 보내는 값을 ***은닉 상태 (hidden state)*** 라고 한다.  

<img width="231" alt="스크린샷 2022-02-24 오후 3 32 16" src="https://user-images.githubusercontent.com/41066039/155470711-9b4305db-d2b0-4a28-9d6c-af5e55b42641.png">

h 를 은닉상태, t 는 시점, W 는 가중치, x, y 는 각각 입출력을 의미한다.
각 요소는 다음과 같은 식으로 연관된다.

```
h(t) = tanh(Wx * x(t) + Wh * h(t-1) + b)
y(t) = f(Wy * h(t) + b)
f 는 비선형 활성화 함수.
```

### 깊은 순환 신경망

RNN 의 은닉층의 수가 2개 이상인 경우 깊은 순환 신경망이라고 한다.

<img width="544" alt="스크린샷 2022-02-24 오후 4 10 44" src="https://user-images.githubusercontent.com/41066039/155475712-ba4832e5-1f36-42cf-a848-e61175a6d815.png">

### 양방향 순환 신경망

양방향 RNN 은 두 개의 메모리셀을 사용하여 하나는 이전 시점의 은닉상태를 받고, 다른 하나는 이후 시점의 은닉 상태를 받아 현재의 은닉상태를 계산한다.

<img width="754" alt="스크린샷 2022-02-24 오후 4 12 30" src="https://user-images.githubusercontent.com/41066039/155475913-cc8c157e-01ac-4c05-a45f-ec7374a1e0cb.png">

## LSTM (Long Short-Term Memory)

RNN 은 시점의 개수가 많아질 수록 앞쪽 정보가 뒤로 충분히 전달되지 못하는 현상이 발생한다. 이를 장기 의존성 문제라고 하며 이러한 문제를 보완한 RNN 의 일종을 장단기 메모리 (LSTM) 라고 한다.
LSTM 은 메모리 셀에 입력 게이트, 삭제 게이트, 출력 게이트를 추가하여 불필요한 기억을 지우고 기억해야할 데이터를 결정한다. 

<img width="660" alt="스크린샷 2022-02-24 오후 4 24 15" src="https://user-images.githubusercontent.com/41066039/155477478-0b0f3124-871b-43b1-a8f1-1653cf875aa8.png">

### 입력 게이트

<img width="532" alt="스크린샷 2022-02-24 오후 4 25 27" src="https://user-images.githubusercontent.com/41066039/155477718-a226f436-737e-4eed-82ef-6b3ffb21a48c.png">

입력 게이트는 현재 정보를 기억하기 위한 게이트이다. 시그모이드 함수 결과값 (0 ~ 1 사이) 과 tanh 결과값 (-1 ~ 1 사이) 값을 이용하여
 기억할 정보의 양을 정하여 셀 상태(C) 를 계산한다.

### 삭제 게이트

<img width="556" alt="스크린샷 2022-02-24 오후 4 38 22" src="https://user-images.githubusercontent.com/41066039/155479488-7b9fd40b-9a03-4a43-b2a8-f1e00a3e0e1c.png">

삭제 게이트는 기억을 삭제하기 위한 게이트이다. 시그모이드 함수를 통과한 결과 값 (0 ~ 1 사이) 은 삭제 과정을 거친 정보의 양을 의미한다. 이 값 또한 셀 상태를 계산하는데 사용된다.

### 셀 상태

<img width="554" alt="스크린샷 2022-02-24 오후 4 39 48" src="https://user-images.githubusercontent.com/41066039/155479664-b3634c5d-8447-4548-9008-ebc94e63fb59.png">

셀 상태 C 는 LSTM 에서는 장기 상태라고 부르기도 한다. 셀 상태는 입력 게이트의 결과와 삭제 게이트 결과에 영향을 받는데, 삭제 게이트의 값이 작을 수록 이전 장기 상태의 영향력이 적어지고 
입력 게이트의 결과값이 작아지면 이전 상태 값에 크게 영향을 받게 된다.

### 출력 게이트

<img width="540" alt="스크린샷 2022-02-24 오후 4 40 32" src="https://user-images.githubusercontent.com/41066039/155479766-342377c4-071d-417f-9ac1-f55d09f7dbfa.png">

출력게이트는 현재 시점의 은닉 상태 (단기 상태) 를 결정하는데 상ㅇ