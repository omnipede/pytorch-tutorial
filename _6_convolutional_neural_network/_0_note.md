# 합성곱 신경망

## 합성곱 연산이란

커널 (또는 필터) 로 불리는 행렬이 입력 형렬을 훑으면서 겹쳐지는 부분의 값을 곱하고 더하여 출력하는 것을 말한다.

<img width="438" alt="스크린샷 2022-02-16 오후 3 54 17" src="https://user-images.githubusercontent.com/41066039/154212273-42eae92f-9d22-4267-9156-ff74a6821493.png">

출력된 행렬을 특성 맵 (feature map) 라고 한다. 커널은 한번에 한 칸만 움직이는 게 아니라 여러 칸을 움직을 수도 있는데 움직이는 
범위를 스트라이드 (stride) 라고 한다.

## Padding
합성곱 결과 얻은 특성 맵의 크기는 입력 행렬보다 크기가 작아질 수 있다. 특성 맵의 크기가 입력 행렬과 동일한 크기를 갖게 하기 위해
행과 열을 추가하는 작업을 패딩이라고 한다.

<img width="477" alt="스크린샷 2022-02-16 오후 4 01 00" src="https://user-images.githubusercontent.com/41066039/154212921-58afaa14-9a1a-42b9-8cb0-7bfc9371d719.png">

특성 맵의 크기는 아래 식으로 구할 수 있다.

<img width="362" alt="스크린샷 2022-02-16 오후 4 04 11" src="https://user-images.githubusercontent.com/41066039/154213360-aa154c3f-3976-40bf-9800-613a2fc510e5.png">

O 는 특성 맵, I 는 입력 행렬, K 는 커널 행렬, P 는 패딩, S 는 스트라이드를 의미하고 첨자 w, h 는 폭과 너비를 의미한다.

## 합성곱 신경망의 가중치와 편향

합성곱 신경망의 가중치와 편향은 다음 그림처럼 나타낼 수 있다.

<img width="394" alt="스크린샷 2022-02-16 오후 4 06 22" src="https://user-images.githubusercontent.com/41066039/154213655-94462b65-c610-466a-a1c0-494cc49109b0.png">

<img width="373" alt="스크린샷 2022-02-16 오후 4 06 32" src="https://user-images.githubusercontent.com/41066039/154213724-77679567-fa97-4be6-9625-d1d32b6a35a3.png">

다층 퍼셉트론 보다 적은 수의 가중치를 갖고 있음을 알 수 있다.

## 풀링 연산

풀링 연산은 특성 맵 (feature map) 의 크기를 줄이기 위해 수행한다. 합성곱 연산과 유사하게 커널이 입력 행렬을 훑지만 곱의 합을 출력하는게 아니라
커널에 포함되는 원소중 최대 또는 평균값을 출력한다.

<img width="494" alt="스크린샷 2022-02-16 오후 4 13 48" src="https://user-images.githubusercontent.com/41066039/154214559-1be7972b-c247-49a3-9569-43c124dcfed6.png">

